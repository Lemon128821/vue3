import{b as K}from"./bus.40155642.js";import{u as B}from"./limit.231b0a95.js";import{_ as T,d as h,e as N,r as l,o as U,c as j,a as e,w as t,b as u,i as L,k as M,E as $,m as p,F as W,j as z,n as O,t as Q,h as X,G as Y,H as Z,I as ee,J as te}from"./index.bbbda2ab.js";import{g as oe,c as ae}from"./limit.2dd34de0.js";import{r as F}from"./request.5f96fccc.js";const le={class:"mini"},se={__name:"bianji",props:{record:Object},setup(n){const{limit:x}=B(),r=h(null);let i=h(!1);const s=a=>{x.includes("role:edit")?(r.value!=null&&r.value.resetFields(),m.id=a.id,m.name=a.name,m.description=a.description,i.value=!0):p.error("\u5BF9\u4E0D\u8D77\uFF0C\u60A8\u6CA1\u6709\u6267\u884C\u8BE5\u64CD\u4F5C\u7684\u6743\u9650!")},m=N({id:"",name:"",description:""}),w=()=>{i.value=!1};async function I(a){a.id=m.id,K.emit("getFormData",a),i.value=!1}return(a,o)=>{const _=l("a-button"),k=l("a-input"),C=l("a-form-item"),b=l("a-form"),d=l("a-modal");return U(),j("div",null,[e(_,{class:"new",onClick:o[0]||(o[0]=g=>s(n.record)),type:"ghost",style:{"margin-bottom":"16px"}},{default:t(()=>[u("\u7F16\u8F91")]),_:1}),e(d,{visible:M(i),"onUpdate:visible":o[3]||(o[3]=g=>$(i)?i.value=g:i=g),title:"\u7F16\u8F91\u89D2\u8272",footer:null,closable:!1},{default:t(()=>[e(b,{model:m,ref_key:"resetf",ref:r,onFinish:I,autocomplete:"off"},{default:t(()=>[e(C,{label:"\u89D2\u8272\u540D\u79F0",name:"name",rules:[{required:!0,message:"\u8F93\u5165\u4E0D\u80FD\u4E3A\u7A7A!"}]},{default:t(()=>[e(k,{value:m.name,"onUpdate:value":o[1]||(o[1]=g=>m.name=g),placeholder:"\u8BF7\u8F93\u5165\u89D2\u8272\u540D\u79F0"},null,8,["value"])]),_:1}),e(C,{label:"\u89D2\u8272\u63CF\u8FF0",name:"description",rules:[{required:!0,message:"\u8F93\u5165\u4E0D\u80FD\u4E3A\u7A7A!"}]},{default:t(()=>[e(k,{value:m.description,"onUpdate:value":o[2]||(o[2]=g=>m.description=g),placeholder:"\u8BF7\u8F93\u5165\u89D2\u8272\u63CF\u8FF0"},null,8,["value"])]),_:1}),L("div",le,[e(_,{onClick:w,style:{right:"5px"}},{default:t(()=>[u("\u53D6\u6D88")]),_:1}),e(_,{type:"primary",htmlType:"submit"},{default:t(()=>[u("\u786E\u8BA4")]),_:1})])]),_:1},8,["model"])]),_:1},8,["visible"])])}}},ne=T(se,[["__scopeId","data-v-58afed35"]]);const re={class:"mini"},ie={__name:"Limit",props:{record:Object},setup(n){const{limit:x}=B();B();const r=h([]),i=h([]);let s=h(!1);const m=async a=>{if(x.includes("role:allotPermission")){let o=await oe(a);i.value=o.list,r.value=o.listTwo,s.value=!0}else p.error("\u5BF9\u4E0D\u8D77\uFF0C\u60A8\u6CA1\u6709\u6267\u884C\u8BE5\u64CD\u4F5C\u7684\u6743\u9650!")},w=async a=>{const o={roleId:a,permissionIds:r.value};await ae(o),p.success("\u5206\u914D\u6210\u529F"),s.value=!1},I=()=>{s.value=!1};return(a,o)=>{const _=l("a-button"),k=l("a-checkbox"),C=l("a-checkbox-group"),b=l("a-modal");return U(),j("div",null,[e(_,{class:"new",onClick:o[0]||(o[0]=d=>m(n.record.id)),type:"ghost",style:{"margin-bottom":"16px"}},{default:t(()=>[u("\u5206\u914D\u6743\u9650")]),_:1}),e(b,{visible:M(s),"onUpdate:visible":o[3]||(o[3]=d=>$(s)?s.value=d:s=d),title:"\u5206\u914D\u6743\u9650",footer:null,closable:!1},{default:t(()=>[e(C,{value:r.value,"onUpdate:value":o[1]||(o[1]=d=>r.value=d)},{default:t(()=>[(U(!0),j(W,null,z(i.value,d=>(U(),O(k,{value:d.id,key:d.id},{default:t(()=>[u(Q(d.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"]),L("div",re,[e(_,{onClick:I,style:{right:"5px"}},{default:t(()=>[u("\u53D6\u6D88")]),_:1}),e(_,{type:"primary",onClick:o[2]||(o[2]=d=>w(n.record.id))},{default:t(()=>[u("\u786E\u8BA4")]),_:1})])]),_:1},8,["visible"])])}}},de=T(ie,[["__scopeId","data-v-32bf9f30"]]),ce=n=>F({url:"/role/selectAll",method:"post",data:{name:n}}),ue=n=>F({url:"/role/deleteById",method:"post",data:n,headers:{"Content-Type":"application/json;charset=utf-8"}}),me=n=>F({url:"/role/deleteByIds",method:"post",data:n,headers:{"Content-Type":"application/json;charset=utf-8"}}),_e=n=>F({url:"/role/insert",method:"post",data:n}),pe=n=>F({url:"/role/updateById",method:"post",data:n});const fe={class:"head"},ve={class:"mini"},ye={class:"middle"},be={__name:"UserManage",setup(n){const x=h(null),{limit:r}=B();X(()=>{s()});const i=h([]);async function s(c){let f=await ce(c);i.value=f.list,i.value.forEach(v=>{v.key=v.id})}let m=[{title:"\u89D2\u8272\u540D\u79F0",dataIndex:"name"},{title:"\u63CF\u8FF0",dataIndex:"description"},{title:"\u64CD\u4F5C",dataIndex:"operate"}];const w=N({selectedRowKeys:[]}),I=c=>{w.selectedRowKeys=c};let a=h(!1);const o=()=>{r.includes("role:select")?r.includes("role:insert")?(x.value!=null&&x.value.resetFields(),a.value=!0):p.error("\u5BF9\u4E0D\u8D77\uFF0C\u60A8\u6CA1\u6709\u6267\u884C\u8BE5\u64CD\u4F5C\u7684\u6743\u9650!"):p.error("\u8BF7\u8054\u7CFB\u7BA1\u7406\u5458\u83B7\u53D6\u67E5\u770B\u6743\u9650\u518D\u8FDB\u884C\u6B64\u64CD\u4F5C!")},_=N({name:"",description:""}),k=()=>{a.value=!1};async function C(c){await _e(c),s(),p.success("\u6DFB\u52A0\u6210\u529F"),a.value=!1}const b=h(""),d=()=>{s(b.value)},g=()=>{b.value=""};Y(b,c=>{c===""&&s(c)}),K.on("getFormData",async c=>{await pe(c),s(),p.success("\u4FEE\u6539\u6210\u529F")});const V=async c=>{r.includes("role:delete")?(await ue(c),s(),p.success("\u5220\u9664\u6210\u529F")):p.error("\u5BF9\u4E0D\u8D77\uFF0C\u60A8\u6CA1\u6709\u6267\u884C\u8BE5\u64CD\u4F5C\u7684\u6743\u9650!")},E=async()=>{r.includes("role:select")?r.includes("role:delete")?w.selectedRowKeys.length?(await me(w.selectedRowKeys),s(),p.success("\u5220\u9664\u6210\u529F")):p.warning("\u5220\u9664\u7684\u5185\u5BB9\u4E0D\u80FD\u4E3A\u7A7A"):p.error("\u5BF9\u4E0D\u8D77\uFF0C\u60A8\u6CA1\u6709\u6267\u884C\u8BE5\u64CD\u4F5C\u7684\u6743\u9650!"):p.error("\u8BF7\u8054\u7CFB\u7BA1\u7406\u5458\u83B7\u53D6\u67E5\u770B\u6743\u9650\u518D\u8FDB\u884C\u6B64\u64CD\u4F5C!")};return Z(()=>{K.all.clear()}),(c,f)=>{const v=l("a-button"),q=l("a-popconfirm"),A=l("SearchOutlined"),R=l("a-input"),D=l("a-form-item"),G=l("a-form"),H=l("a-modal"),J=l("a-space"),P=l("a-table");return U(),j("div",fe,[e(v,{class:"new",onClick:o,type:"primary"},{default:t(()=>[u("\u65B0\u589E\u89D2\u8272")]),_:1}),e(q,{title:"\u4F60\u786E\u5B9A\u8981\u5220\u9664\u5417?","ok-text":"\u786E\u8BA4","cancel-text":"\u53D6\u6D88",onConfirm:E},{default:t(()=>[e(v,{class:"new",type:"danger"},{default:t(()=>[u("\u6279\u91CF\u5220\u9664")]),_:1})]),_:1}),e(R,{type:"text",placeholder:"\u6839\u636E\u89D2\u8272\u540D\u79F0",value:b.value,"onUpdate:value":f[0]||(f[0]=y=>b.value=y)},{prefix:t(()=>[e(A,{class:"site-form-item-icon"})]),_:1},8,["value"]),e(v,{type:"primary",onClick:d},{default:t(()=>[u("\u67E5\u8BE2")]),_:1}),e(v,{type:"primary",onClick:g,style:{margin:"10px"}},{default:t(()=>[u("\u91CD\u7F6E")]),_:1}),e(H,{visible:M(a),"onUpdate:visible":f[3]||(f[3]=y=>$(a)?a.value=y:a=y),title:"\u65B0\u589E\u89D2\u8272",footer:null,closable:!1},{default:t(()=>[e(G,{model:_,ref_key:"resetf",ref:x,onFinish:C,autocomplete:"off"},{default:t(()=>[e(D,{label:"\u89D2\u8272\u540D\u79F0",name:"name",rules:[{required:!0,message:"\u8F93\u5165\u4E0D\u80FD\u4E3A\u7A7A!"}]},{default:t(()=>[e(R,{value:_.name,"onUpdate:value":f[1]||(f[1]=y=>_.name=y),placeholder:"\u8BF7\u8F93\u5165\u89D2\u8272\u540D\u79F0"},null,8,["value"])]),_:1}),e(D,{label:"\u89D2\u8272\u63CF\u8FF0",name:"description",rules:[{required:!0,message:"\u8F93\u5165\u4E0D\u80FD\u4E3A\u7A7A!"}]},{default:t(()=>[e(R,{value:_.description,"onUpdate:value":f[2]||(f[2]=y=>_.description=y),placeholder:"\u8BF7\u8F93\u5165\u89D2\u8272\u63CF\u8FF0"},null,8,["value"])]),_:1}),L("div",ve,[e(v,{onClick:k,style:{right:"5px"}},{default:t(()=>[u("\u53D6\u6D88")]),_:1}),e(v,{type:"primary",htmlType:"submit"},{default:t(()=>[u("\u786E\u8BA4")]),_:1})])]),_:1},8,["model"])]),_:1},8,["visible"]),L("div",ye,[e(P,{dataSource:i.value,columns:M(m),"row-selection":{selectedRowKeys:w.selectedRowKeys,onChange:I}},{bodyCell:t(({column:y,record:S})=>[y.dataIndex==="operate"?(U(),O(J,{key:0},{default:t(()=>[e(de,{record:S},null,8,["record"]),e(ne,{record:S},null,8,["record"]),e(q,{title:"\u4F60\u786E\u5B9A\u8981\u5220\u9664\u5417?","ok-text":"\u786E\u8BA4","cancel-text":"\u53D6\u6D88",onConfirm:ge=>V(S.id)},{default:t(()=>[e(v,{class:"new",type:"ghost"},{default:t(()=>[u("\u5220\u9664")]),_:1})]),_:2},1032,["onConfirm"])]),_:2},1024)):ee("",!0)]),default:t(()=>[te(c.$slots,"bodyCell",{},void 0,!0)]),_:3},8,["dataSource","columns","row-selection"])])])}}},Ue=T(be,[["__scopeId","data-v-0453a036"]]);export{Ue as default};
