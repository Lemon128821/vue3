import{b as B}from"./bus.40155642.js";import{_ as N,d as y,y as Y,e as $,r as d,o as I,c as F,a as e,w as t,b as p,F as K,j,i as v,t as R,m as f,n as E,h as O,G as V,H as z,p as L,l as G}from"./index.bbbda2ab.js";import"./zh-cn.f0d712c4.js";import{u as q}from"./limit.231b0a95.js";import{r as S}from"./request.5f96fccc.js";const P={class:"sel"},W={__name:"Add",props:{dptData:Array,empData:Array},setup(s){const{limit:w}=q(),h=y(null);Y.locale("zh-cn");const g=()=>Y().format("YYYY-MM-DD HH:mm:ss"),x=y(g()),i=y(!1),k=async()=>{w.includes("department:select")?w.includes("department:insert")?(h.value!=null&&h.value.resetFields(),x.value=g(),i.value=!0):f.error("\u5BF9\u4E0D\u8D77\uFF0C\u60A8\u6CA1\u6709\u6267\u884C\u8BE5\u64CD\u4F5C\u7684\u6743\u9650!"):f.error("\u8BF7\u8054\u7CFB\u7BA1\u7406\u5458\u83B7\u53D6\u67E5\u770B\u6743\u9650\u518D\u8FDB\u884C\u6B64\u64CD\u4F5C!")},T=()=>{i.value=!1},c=$({name:"",parentId:1,leaderId:1,status:"\u542F\u7528"}),m=C=>{C.modnDate=x.value,B.emit("getFormData",C),i.value=!1};return(C,r)=>{const o=d("a-button"),A=d("a-input"),l=d("a-form-item"),a=d("a-select-option"),_=d("a-select"),b=d("a-form"),D=d("a-modal");return I(),F(K,null,[e(o,{type:"primary",onClick:k},{default:t(()=>[p("\u65B0\u589E")]),_:1}),e(D,{visible:i.value,"onUpdate:visible":r[4]||(r[4]=n=>i.value=n),title:"\u65B0\u589E\u90E8\u95E8",footer:null,closable:!1},{default:t(()=>[e(b,{model:c,ref_key:"resetf",ref:h,"label-col":{span:8},"wrapper-col":{span:12},autocomplete:"off",onFinish:m},{default:t(()=>[e(l,{label:"\u90E8\u95E8\u540D\u79F0",name:"name",rules:[{required:!0,message:"\u8F93\u5165\u4E0D\u80FD\u4E3A\u7A7A!"}]},{default:t(()=>[e(A,{value:c.name,"onUpdate:value":r[0]||(r[0]=n=>c.name=n)},null,8,["value"])]),_:1}),e(l,{label:"\u4E0A\u7EA7\u90E8\u95E8",name:"parentId"},{default:t(()=>[e(_,{value:c.parentId,"onUpdate:value":r[1]||(r[1]=n=>c.parentId=n)},{default:t(()=>[(I(!0),F(K,null,j(s.dptData,n=>(I(),E(a,{key:n.id,value:n.id},{default:t(()=>[p(R(n.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1}),e(l,{label:"\u90E8\u95E8\u8D1F\u8D23\u4EBA",name:"leaderId"},{default:t(()=>[e(_,{value:c.leaderId,"onUpdate:value":r[2]||(r[2]=n=>c.leaderId=n)},{default:t(()=>[(I(!0),F(K,null,j(s.empData,n=>(I(),E(a,{key:n.id,value:n.id},{default:t(()=>[p(R(n.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1}),e(l,{label:"\u72B6\u6001",name:"status"},{default:t(()=>[e(_,{value:c.status,"onUpdate:value":r[3]||(r[3]=n=>c.status=n)},{default:t(()=>[e(a,{value:"\u542F\u7528"},{default:t(()=>[p("\u542F\u7528")]),_:1}),e(a,{value:"\u7981\u6B62"},{default:t(()=>[p("\u7981\u6B62")]),_:1})]),_:1},8,["value"])]),_:1}),e(l,{label:"\u6700\u540E\u4FEE\u6539\u65F6\u95F4"},{default:t(()=>[v("span",null,R(x.value),1)]),_:1}),v("div",P,[e(o,{type:"primary",onClick:T},{default:t(()=>[p("\u53D6\u6D88")]),_:1}),e(o,{type:"primary",htmlType:"submit"},{default:t(()=>[p("\u786E\u8BA4")]),_:1})])]),_:1},8,["model"])]),_:1},8,["visible"])],64)}}},J=N(W,[["__scopeId","data-v-3de9e0c5"]]),Q=s=>S({url:"/department/selectAll",method:"post",data:{name:s}}),X=s=>S({url:"/department/selectOptionalParentDepartment",method:"post",data:s,headers:{"Content-Type":"application/json;charset=utf-8"}}),Z=s=>S({url:"/department/selectById",method:"post",data:s,headers:{"Content-Type":"application/json;charset=utf-8"}}),ee=s=>S({url:"/department/deleteByIds",method:"post",data:s,headers:{"Content-Type":"application/json;charset=utf-8"}}),te=s=>S({url:"/department/insert",method:"post",data:s}),ae=s=>S({url:"/department/updateById",method:"post",data:s});const le={class:"sel"},ne={__name:"Edit",props:{currentIndex:Array,empData:Array},setup(s){const w=s,{limit:h}=q(),g=y(null);Y.locale("zh-cn");const x=()=>Y().format("YYYY-MM-DD HH:mm:ss"),i=y(w.currentIndex),k=y([]);B.on("getCurrentData",async l=>{i.value=l});const T=async()=>{if(h.includes("department:select"))if(h.includes("department:edit"))if(!i.value.length)f.warning("\u7F16\u8F91\u7684\u6570\u636E\u4E0D\u80FD\u4E3A\u7A7A!");else if(i.value.length&&i.value.length>=2)f.warning("\u53EA\u80FD\u7F16\u8F91\u4E00\u6761\u6570\u636E\u54E6!");else if(i.value[0]===1)f.warning("\u8FD9\u6761\u6570\u636E\u4E0D\u80FD\u7F16\u8F91\u54E6!");else{g.value!=null&&g.value.resetFields();let l=await X(i.value[0]);k.value=l.list;let a=await Z(i.value[0]);A(a.object),m.value=!0}else f.error("\u5BF9\u4E0D\u8D77\uFF0C\u60A8\u6CA1\u6709\u6267\u884C\u8BE5\u64CD\u4F5C\u7684\u6743\u9650!");else f.error("\u8BF7\u8054\u7CFB\u7BA1\u7406\u5458\u83B7\u53D6\u67E5\u770B\u6743\u9650\u518D\u8FDB\u884C\u6B64\u64CD\u4F5C!")},c=l=>{l.id=o.id,l.modnDate=x(),B.emit("replace",l),m.value=!1},m=y(!1),C=()=>{m.value=!1},r=y(""),o=$({name:"",parentId:1,leaderId:0,status:"\u542F\u7528",id:0}),A=l=>{o.name=l.name,o.parentId=l.parentId,o.leaderId=l.leader!==null?l.leaderId:null,o.status=l.status,r.value=l.modnDate,o.id=l.id};return(l,a)=>{const _=d("a-button"),b=d("a-input"),D=d("a-form-item"),n=d("a-select-option"),U=d("a-select"),M=d("a-form"),H=d("a-modal");return I(),F(K,null,[e(_,{type:"primary",onClick:T},{default:t(()=>[p("\u7F16\u8F91")]),_:1}),e(H,{visible:m.value,"onUpdate:visible":a[4]||(a[4]=u=>m.value=u),title:"\u7F16\u8F91\u90E8\u95E8",footer:null,closable:!1},{default:t(()=>[e(M,{model:o,ref_key:"resetf",ref:g,"label-col":{span:8},"wrapper-col":{span:12},autocomplete:"off",onFinish:c},{default:t(()=>[e(D,{label:"\u90E8\u95E8\u540D\u79F0",name:"name",rules:[{required:!0,message:"\u8F93\u5165\u4E0D\u80FD\u4E3A\u7A7A!"}]},{default:t(()=>[e(b,{value:o.name,"onUpdate:value":a[0]||(a[0]=u=>o.name=u)},null,8,["value"])]),_:1}),e(D,{label:"\u4E0A\u7EA7\u90E8\u95E8",name:"parentId"},{default:t(()=>[e(U,{value:o.parentId,"onUpdate:value":a[1]||(a[1]=u=>o.parentId=u)},{default:t(()=>[(I(!0),F(K,null,j(k.value,u=>(I(),E(n,{key:u.id,value:u.id},{default:t(()=>[p(R(u.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1}),e(D,{label:"\u90E8\u95E8\u8D1F\u8D23\u4EBA",name:"leaderId"},{default:t(()=>[e(U,{value:o.leaderId,"onUpdate:value":a[2]||(a[2]=u=>o.leaderId=u)},{default:t(()=>[(I(!0),F(K,null,j(s.empData,u=>(I(),E(n,{key:u.id,value:u.id},{default:t(()=>[p(R(u.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1}),e(D,{label:"\u72B6\u6001",name:"status"},{default:t(()=>[e(U,{value:o.status,"onUpdate:value":a[3]||(a[3]=u=>o.status=u)},{default:t(()=>[e(n,{value:"\u542F\u7528"},{default:t(()=>[p("\u542F\u7528")]),_:1}),e(n,{value:"\u7981\u6B62"},{default:t(()=>[p("\u7981\u6B62")]),_:1})]),_:1},8,["value"])]),_:1}),e(D,{label:"\u6700\u540E\u4FEE\u6539\u65F6\u95F4"},{default:t(()=>[v("span",null,R(r.value),1)]),_:1}),v("div",le,[e(_,{type:"primary",onClick:C},{default:t(()=>[p("\u53D6\u6D88")]),_:1}),e(_,{type:"primary",htmlType:"submit"},{default:t(()=>[p("\u786E\u8BA4")]),_:1})])]),_:1},8,["model"])]),_:1},8,["visible"])],64)}}},se=N(ne,[["__scopeId","data-v-7bc7e08e"]]);const oe=s=>(L("data-v-37751e06"),s=s(),G(),s),de={class:"tree"},re=oe(()=>v("h1",null,"\u90E8\u95E8\u6811",-1)),ue={style:{width:"80%",float:"left","background-color":"#fff"}},ce={class:"search"},ie={class:"btn"},pe={class:"add"},me={class:"update"},_e={class:"del"},fe={__name:"Team",setup(s){const{limit:w}=q(),h=y([{name:"0-0",id:"0-0",departments:[{name:"0-0-0",id:"0-0-0",departments:[{name:"0-0-0-0",id:"0-0-0-0"}]},{name:"0-0-1",id:"0-0-1",departments:[{name:"0-0-1-0",id:"0-0-1-0"}]}]}]),g={title:"name",key:"id",children:"departments"},x=[{title:"\u90E8\u95E8\u540D\u79F0",dataIndex:"name"},{title:"\u4E0A\u7EA7\u90E8\u95E8",dataIndex:"pDept"},{title:"\u90E8\u95E8\u8D1F\u8D23\u4EBA",dataIndex:"leader"},{title:"\u72B6\u6001",dataIndex:"status"},{title:"\u6700\u540E\u4FEE\u6539\u65F6\u95F4",dataIndex:"modnDate"}],i=y([]),k=y([]),T=y([]),c=async a=>{let _=await Q(a);h.value=_.listTwo,i.value=_.list,k.value=_.list,T.value=_.listThree,i.value.forEach(b=>{b.pDept=b.department!==null?b.department.name:"",b.key=b.id})};O(()=>{c()});const m=$({selectedRowKeys:[]}),C=a=>{m.selectedRowKeys=a,B.emit("getCurrentData",m.selectedRowKeys)},r=y(""),o=()=>{c(r.value)},A=()=>{r.value=""};V(r,a=>{a===""&&c(a)}),B.on("getFormData",async a=>{await te(a),c(),f.success("\u65B0\u589E\u6210\u529F")}),B.on("replace",async a=>{await ae(a),c(),f.success("\u4FEE\u6539\u6210\u529F")});const l=async()=>{w.includes("department:select")?w.includes("department:delete")?m.selectedRowKeys.length?m.selectedRowKeys.length&&m.selectedRowKeys.forEach(async a=>{a===1?f.warning("\u8FD9\u6761\u6570\u636E\u4E0D\u80FD\u5220\u9664\u54E6!"):(await ee(m.selectedRowKeys),c(),f.success("\u5220\u9664\u6210\u529F"))}):f.warning("\u5220\u9664\u7684\u5185\u5BB9\u4E0D\u80FD\u4E3A\u7A7A"):f.error("\u5BF9\u4E0D\u8D77\uFF0C\u60A8\u6CA1\u6709\u6267\u884C\u8BE5\u64CD\u4F5C\u7684\u6743\u9650!"):f.error("\u8BF7\u8054\u7CFB\u7BA1\u7406\u5458\u83B7\u53D6\u67E5\u770B\u6743\u9650\u518D\u8FDB\u884C\u6B64\u64CD\u4F5C!")};return z(()=>{B.all.clear()}),(a,_)=>{const b=d("a-tree"),D=d("SearchOutlined"),n=d("a-input"),U=d("a-button"),M=d("a-popconfirm"),H=d("a-table");return I(),F(K,null,[v("div",de,[re,e(b,{"default-expand-allblock-node":"","tree-data":h.value,"field-names":g},null,8,["tree-data"])]),v("div",ue,[v("div",ce,[e(n,{type:"text",placeholder:"\u6839\u636E\u90E8\u95E8\u540D\u79F0",value:r.value,"onUpdate:value":_[0]||(_[0]=u=>r.value=u)},{prefix:t(()=>[e(D,{class:"site-form-item-icon"})]),_:1},8,["value"]),e(U,{type:"primary",onClick:o},{default:t(()=>[p("\u67E5\u8BE2")]),_:1}),e(U,{type:"primary",onClick:A},{default:t(()=>[p("\u91CD\u7F6E")]),_:1})]),v("div",ie,[v("div",pe,[e(J,{dptData:k.value,empData:T.value},null,8,["dptData","empData"])]),v("div",me,[e(se,{currentIndex:m.selectedRowKeys,empData:T.value},null,8,["currentIndex","empData"])]),v("div",_e,[e(M,{title:"\u4F60\u786E\u5B9A\u8981\u5220\u9664\u5417?","ok-text":"\u786E\u8BA4","cancel-text":"\u53D6\u6D88",onConfirm:l},{default:t(()=>[e(U,{type:"danger"},{default:t(()=>[p("\u5220\u9664")]),_:1})]),_:1})])]),v("div",null,[e(H,{"row-selection":{selectedRowKeys:m.selectedRowKeys,onChange:C},columns:x,"data-source":i.value},null,8,["row-selection","data-source"])])])],64)}}},De=N(fe,[["__scopeId","data-v-37751e06"]]);export{De as default};
