import{r as C}from"./request.5f96fccc.js";import{b as N}from"./bus.40155642.js";import{u as A}from"./limit.231b0a95.js";import{_ as E,d as w,e as K,r,o as x,c as D,a as e,w as t,b as c,F as S,j,i as q,m as _,n as T,t as M,k as P,E as V,h as L,G as O,H as G}from"./index.bbbda2ab.js";const H=d=>C({url:"/employee/selectAll",method:"post",data:{name:d}}),W=d=>C({url:"/employee/selectById",method:"post",data:d,headers:{"Content-Type":"application/json;charset=utf-8"}}),z=d=>C({url:"/role/selectByEmployeeId",method:"post",data:d,headers:{"Content-Type":"application/json;charset=utf-8"}}),J=d=>C({url:"/role/allotRole",method:"post",data:d}),Q=d=>C({url:"/employee/deleteByIds",method:"post",data:d,headers:{"Content-Type":"application/json;charset=utf-8"}}),X=d=>C({url:"/employee/insert",method:"post",data:d}),Y=d=>C({url:"/employee/updateById",method:"post",data:d}),Z=d=>C({url:"/employee/verifyInsert",method:"post",data:{loginName:d}});const ee={class:"sel"},te={__name:"Add",props:{selData:Array},setup(d){const{limit:h}=A(),g=w(null),v=f=>{N.emit("addData",f),i.value=!1},i=w(!1),k=()=>{h.includes("employee:select")?h.includes("employee:insert")?(s(),i.value=!0,g.value!=null&&g.value.resetFields()):_.error("\u5BF9\u4E0D\u8D77\uFF0C\u60A8\u6CA1\u6709\u6267\u884C\u8BE5\u64CD\u4F5C\u7684\u6743\u9650!"):_.error("\u8BF7\u8054\u7CFB\u7BA1\u7406\u5458\u83B7\u53D6\u67E5\u770B\u6743\u9650\u518D\u8FDB\u884C\u6B64\u64CD\u4F5C!")},p=async(f,a)=>{const{message:n,result:m}=await Z(o.loginName),u=/^1[3-9]\d{9}$/;return a===""?Promise.reject("\u767B\u5F55\u540D\u4E0D\u80FD\u4E3A\u7A7A"):u.test(a)?m?Promise.resolve():Promise.reject(n):Promise.reject("\u683C\u5F0F\u4E0D\u5BF9")},I=()=>{i.value=!1},o=K({loginName:"",password:"",name:"",empNum:"",deptId:1,phone:"",gender:"\u7537",email:""}),s=()=>{o.loginName="13600000002",o.password="123456",o.name="\u73A9\u73A9",o.empNum="",o.deptId=1,o.phone="13445656741",o.gender="\u7537",o.email="22@qq.cn"};return(f,a)=>{const n=r("a-button"),m=r("a-input"),u=r("a-form-item"),b=r("a-input-password"),y=r("a-select-option"),R=r("a-select"),U=r("a-radio"),B=r("a-radio-group"),F=r("a-form"),$=r("a-modal");return x(),D("div",null,[e(n,{type:"primary",onClick:k},{default:t(()=>[c("\u65B0\u589E\u5458\u5DE5")]),_:1}),e($,{visible:i.value,"onUpdate:visible":a[8]||(a[8]=l=>i.value=l),title:"\u65B0\u589E\u5458\u5DE5",footer:null,closable:!1},{default:t(()=>[e(F,{model:o,ref_key:"resetf",ref:g,"label-col":{span:8},"wrapper-col":{span:12},autocomplete:"off",onFinish:v},{default:t(()=>[e(u,{label:"\u767B\u5F55\u540D",name:"loginName",rules:[{validator:p,trigger:["blur"]}]},{default:t(()=>[e(m,{value:o.loginName,"onUpdate:value":a[0]||(a[0]=l=>o.loginName=l)},null,8,["value"])]),_:1},8,["rules"]),e(u,{label:"\u5BC6\u7801",name:"password",rules:[{required:!0,message:"\u8F93\u5165\u4E0D\u80FD\u4E3A\u7A7A!"}]},{default:t(()=>[e(b,{value:o.password,"onUpdate:value":a[1]||(a[1]=l=>o.password=l)},null,8,["value"])]),_:1}),e(u,{label:"\u59D3\u540D",name:"name",rules:[{required:!0,message:"\u8F93\u5165\u4E0D\u80FD\u4E3A\u7A7A!",trigger:["change","blur"]}]},{default:t(()=>[e(m,{value:o.name,"onUpdate:value":a[2]||(a[2]=l=>o.name=l)},null,8,["value"])]),_:1}),e(u,{label:"\u5458\u5DE5\u7F16\u53F7",name:"empNum",rules:[{required:!0,message:"\u8F93\u5165\u4E0D\u80FD\u4E3A\u7A7A!"},{pattern:/^[0-9]{1,3}$/,message:"\u6700\u5927\u53EA\u80FD\u8F93\u5165\u4E09\u4F4D\u6570\u5B57!"}]},{default:t(()=>[e(m,{value:o.empNum,"onUpdate:value":a[3]||(a[3]=l=>o.empNum=l)},null,8,["value"])]),_:1}),e(u,{label:"\u90E8\u95E8",name:"deptId"},{default:t(()=>[e(R,{value:o.deptId,"onUpdate:value":a[4]||(a[4]=l=>o.deptId=l)},{default:t(()=>[(x(!0),D(S,null,j(d.selData,l=>(x(),T(y,{key:l.id,value:l.id},{default:t(()=>[c(M(l.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1}),e(u,{label:"\u7535\u8BDD",name:"phone",rules:[{required:!0,message:"\u8F93\u5165\u4E0D\u80FD\u4E3A\u7A7A!"},{pattern:/^1[3-9]\d{9}$/,message:"\u624B\u673A\u53F7\u7801\u65E0\u6548"}]},{default:t(()=>[e(m,{value:o.phone,"onUpdate:value":a[5]||(a[5]=l=>o.phone=l)},null,8,["value"])]),_:1}),e(u,{label:"\u6027\u522B",name:"gender"},{default:t(()=>[e(B,{value:o.gender,"onUpdate:value":a[6]||(a[6]=l=>o.gender=l)},{default:t(()=>[e(U,{value:"\u7537"},{default:t(()=>[c("\u7537")]),_:1}),e(U,{value:"\u5973"},{default:t(()=>[c("\u5973")]),_:1})]),_:1},8,["value"])]),_:1}),e(u,{label:"\u7535\u5B50\u90AE\u7BB1",name:"email",rules:[{required:!0,message:"\u8F93\u5165\u4E0D\u80FD\u4E3A\u7A7A!"},{pattern:/\S+@\S+\.\S+/,message:"\u7535\u5B50\u90AE\u7BB1\u65E0\u6548"}]},{default:t(()=>[e(m,{value:o.email,"onUpdate:value":a[7]||(a[7]=l=>o.email=l)},null,8,["value"])]),_:1},8,["rules"]),q("div",ee,[e(n,{type:"primary",onClick:I},{default:t(()=>[c("\u53D6\u6D88")]),_:1}),e(n,{type:"primary",htmlType:"submit"},{default:t(()=>[c("\u786E\u8BA4")]),_:1})])]),_:1},8,["model"])]),_:1},8,["visible"])])}}},ae=E(te,[["__scopeId","data-v-9c5babc4"]]);const le={class:"sel"},ne={__name:"Edit",props:{currentIndex:Array,selData:Array},setup(d){const h=d,{limit:g}=A(),v=w(null),i=w(h.currentIndex);N.on("getCurrentData",a=>{i.value=a});const k=async()=>{if(g.includes("employee:select"))if(g.includes("employee:edit"))if(!i.value.length)_.warning("\u7F16\u8F91\u7684\u6570\u636E\u4E0D\u80FD\u4E3A\u7A7A!");else if(i.value.length&&i.value.length>=2)_.warning("\u53EA\u80FD\u7F16\u8F91\u4E00\u6761\u6570\u636E\u54E6!");else{v.value!=null&&v.value.resetFields();let a=await W(i.value[0]);f(a.object),I.value=!0}else _.error("\u5BF9\u4E0D\u8D77\uFF0C\u60A8\u6CA1\u6709\u6267\u884C\u8BE5\u64CD\u4F5C\u7684\u6743\u9650!");else _.error("\u8BF7\u8054\u7CFB\u7BA1\u7406\u5458\u83B7\u53D6\u67E5\u770B\u6743\u9650\u518D\u8FDB\u884C\u6B64\u64CD\u4F5C!")},p=a=>{a.id=s.id,N.emit("updata",a),I.value=!1},I=w(!1),o=()=>{I.value=!1},s=K({name:"",empNum:"",deptId:1,phone:"",gender:"",email:"",id:0}),f=a=>{s.id=a.id,s.name=a.name,s.empNum=a.empNum,s.deptId=a.deptId,s.phone=a.phone,s.gender=a.gender,s.email=a.email};return(a,n)=>{const m=r("a-button"),u=r("a-input"),b=r("a-form-item"),y=r("a-select-option"),R=r("a-select"),U=r("a-radio"),B=r("a-radio-group"),F=r("a-form"),$=r("a-modal");return x(),D("div",null,[e(m,{type:"primary",style:{"margin-right":"10px"},onClick:k},{default:t(()=>[c("\u7F16\u8F91")]),_:1}),e($,{visible:I.value,"onUpdate:visible":n[6]||(n[6]=l=>I.value=l),title:"\u7F16\u8F91\u5458\u5DE5",footer:null,closable:!1},{default:t(()=>[e(F,{model:s,ref_key:"resetf",ref:v,"label-col":{span:8},"wrapper-col":{span:12},autocomplete:"off",onFinish:p},{default:t(()=>[e(b,{label:"\u59D3\u540D",name:"name",rules:[{required:!0,message:"\u8F93\u5165\u4E0D\u80FD\u4E3A\u7A7A!"}]},{default:t(()=>[e(u,{value:s.name,"onUpdate:value":n[0]||(n[0]=l=>s.name=l)},null,8,["value"])]),_:1}),e(b,{label:"\u5458\u5DE5\u7F16\u53F7",name:"empNum",rules:[{required:!0,message:"\u8F93\u5165\u4E0D\u80FD\u4E3A\u7A7A!"},{pattern:/^[0-9]{1,3}$/,message:"\u6700\u5927\u53EA\u80FD\u8F93\u5165\u4E09\u4F4D\u6570\u5B57!"}]},{default:t(()=>[e(u,{value:s.empNum,"onUpdate:value":n[1]||(n[1]=l=>s.empNum=l)},null,8,["value"])]),_:1}),e(b,{label:"\u90E8\u95E8",name:"deptId"},{default:t(()=>[e(R,{value:s.deptId,"onUpdate:value":n[2]||(n[2]=l=>s.deptId=l)},{default:t(()=>[(x(!0),D(S,null,j(d.selData,l=>(x(),T(y,{key:l.id,value:l.id},{default:t(()=>[c(M(l.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1}),e(b,{label:"\u7535\u8BDD",name:"phone",rules:[{required:!0,message:"\u8F93\u5165\u4E0D\u80FD\u4E3A\u7A7A!"},{pattern:/^1[3-9]\d{9}$/,message:"\u624B\u673A\u53F7\u7801\u65E0\u6548"}]},{default:t(()=>[e(u,{value:s.phone,"onUpdate:value":n[3]||(n[3]=l=>s.phone=l)},null,8,["value"])]),_:1}),e(b,{label:"\u6027\u522B",name:"gender"},{default:t(()=>[e(B,{value:s.gender,"onUpdate:value":n[4]||(n[4]=l=>s.gender=l)},{default:t(()=>[e(U,{value:"\u7537"},{default:t(()=>[c("\u7537")]),_:1}),e(U,{value:"\u5973"},{default:t(()=>[c("\u5973")]),_:1})]),_:1},8,["value"])]),_:1}),e(b,{label:"\u7535\u5B50\u90AE\u7BB1",name:"email",rules:[{required:!0,message:"\u8F93\u5165\u4E0D\u80FD\u4E3A\u7A7A!"},{pattern:/\S+@\S+\.\S+/,message:"\u7535\u5B50\u90AE\u7BB1\u65E0\u6548"}]},{default:t(()=>[e(u,{value:s.email,"onUpdate:value":n[5]||(n[5]=l=>s.email=l)},null,8,["value"])]),_:1},8,["rules"]),q("div",le,[e(m,{type:"primary",onClick:o},{default:t(()=>[c("\u53D6\u6D88")]),_:1}),e(m,{type:"primary",htmlType:"submit"},{default:t(()=>[c("\u786E\u8BA4")]),_:1})])]),_:1},8,["model"])]),_:1},8,["visible"])])}}},oe=E(ne,[["__scopeId","data-v-e3054f66"]]);const se={class:"mini"},re={__name:"AssignRole",props:{currentIndex:Array},setup(d){const h=d,{limit:g}=A(),v=w(h.currentIndex);N.on("getCurrentData",f=>{v.value=f});const i=w([]),k=w([]);let p=w(!1);const I=async()=>{if(g.includes("employee:select"))if(g.includes("employee:allotRole"))if(!v.value.length)_.warning("\u8BF7\u9009\u62E9\u8981\u5206\u914D\u89D2\u8272\u7684\u6570\u636E!");else if(v.value.length&&v.value.length>=2)_.warning("\u4E0D\u53EF\u4EE5\u540C\u65F6\u7ED9\u591A\u6761\u6570\u636E\u5206\u914D\u89D2\u8272!");else{let f=await z(v.value[0]);k.value=f.list,i.value=f.listTwo,p.value=!0}else _.error("\u5BF9\u4E0D\u8D77\uFF0C\u60A8\u6CA1\u6709\u6267\u884C\u8BE5\u64CD\u4F5C\u7684\u6743\u9650!");else _.error("\u8BF7\u8054\u7CFB\u7BA1\u7406\u5458\u83B7\u53D6\u67E5\u770B\u6743\u9650\u518D\u8FDB\u884C\u6B64\u64CD\u4F5C!")},o=async()=>{const f={employeeId:v.value[0],roleIds:i.value};await J(f),_.success("\u5206\u914D\u6210\u529F"),p.value=!1},s=()=>{p.value=!1};return(f,a)=>{const n=r("a-button"),m=r("a-checkbox"),u=r("a-checkbox-group"),b=r("a-modal");return x(),D("div",null,[e(n,{onClick:I,type:"primary",style:{"margin-bottom":"16px"}},{default:t(()=>[c("\u5206\u914D\u89D2\u8272")]),_:1}),e(b,{visible:P(p),"onUpdate:visible":a[1]||(a[1]=y=>V(p)?p.value=y:p=y),title:"\u5206\u914D\u89D2\u8272",footer:null,closable:!1},{default:t(()=>[e(u,{value:i.value,"onUpdate:value":a[0]||(a[0]=y=>i.value=y)},{default:t(()=>[(x(!0),D(S,null,j(k.value,y=>(x(),T(m,{key:y.id,value:y.id},{default:t(()=>[c(M(y.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"]),q("div",se,[e(n,{onClick:s,style:{right:"5px"}},{default:t(()=>[c("\u53D6\u6D88")]),_:1}),e(n,{type:"primary",onClick:o},{default:t(()=>[c("\u786E\u8BA4")]),_:1})])]),_:1},8,["visible"])])}}},ue=E(re,[["__scopeId","data-v-9ec4eacf"]]);const de={class:"head"},ie={class:"search"},pe={__name:"emManage",setup(d){const{limit:h}=A(),g=w([]),v=w([]),i=async n=>{let m=await H(n);g.value=m.list,v.value=m.listTwo,g.value.forEach(u=>{u.dept=u.department.name,u.key=u.id})};L(async()=>{i()});const k=[{title:"\u767B\u5F55\u540D",dataIndex:"loginName"},{title:"\u59D3\u540D",dataIndex:"name"},{title:"\u5458\u5DE5\u7F16\u53F7",dataIndex:"empNum"},{title:"\u90E8\u95E8",dataIndex:"dept"},{title:"\u7535\u8BDD",dataIndex:"phone"},{title:"\u6027\u522B",dataIndex:"gender"},{title:"\u7535\u5B50\u90AE\u7BB1",dataIndex:"email"}],p=K({selectedRowKeys:[]}),I=n=>{p.selectedRowKeys=n,N.emit("getCurrentData",p.selectedRowKeys)};N.on("addData",async n=>{await X(n),i(),_.success("\u65B0\u589E\u6210\u529F")}),N.on("updata",async n=>{await Y(n),i(),_.success("\u4FEE\u6539\u6210\u529F")});const o=async()=>{h.includes("employee:select")?h.includes("employee:delete")?p.selectedRowKeys.length?(await Q(p.selectedRowKeys),i(),_.success("\u5220\u9664\u6210\u529F")):(console.log(1),_.warning("\u5220\u9664\u7684\u5185\u5BB9\u4E0D\u80FD\u4E3A\u7A7A")):_.error("\u5BF9\u4E0D\u8D77\uFF0C\u60A8\u6CA1\u6709\u6267\u884C\u8BE5\u64CD\u4F5C\u7684\u6743\u9650!"):_.error("\u8BF7\u8054\u7CFB\u7BA1\u7406\u5458\u83B7\u53D6\u67E5\u770B\u6743\u9650\u518D\u8FDB\u884C\u6B64\u64CD\u4F5C!")},s=w(""),f=()=>{i(s.value)},a=()=>{s.value=""};return O(s,n=>{n===""&&i(n)}),G(()=>{N.all.clear()}),(n,m)=>{const u=r("a-button"),b=r("a-popconfirm"),y=r("SearchOutlined"),R=r("a-input"),U=r("a-table");return x(),D(S,null,[q("div",de,[e(ae,{selData:v.value},null,8,["selData"]),e(oe,{currentIndex:p.selectedRowKeys,selData:v.value},null,8,["currentIndex","selData"]),e(b,{title:"\u4F60\u786E\u5B9A\u8981\u5220\u9664\u5417?","ok-text":"\u786E\u8BA4","cancel-text":"\u53D6\u6D88",onConfirm:o},{default:t(()=>[e(u,{class:"new",type:"danger"},{default:t(()=>[c("\u5220\u9664")]),_:1})]),_:1}),q("div",ie,[e(R,{type:"text",placeholder:"\u6839\u636E\u5458\u5DE5\u59D3\u540D",value:s.value,"onUpdate:value":m[0]||(m[0]=B=>s.value=B)},{prefix:t(()=>[e(y,{class:"site-form-item-icon"})]),_:1},8,["value"]),e(u,{type:"primary",onClick:f},{default:t(()=>[c("\u67E5\u8BE2")]),_:1}),e(u,{type:"primary",onClick:a},{default:t(()=>[c("\u91CD\u7F6E")]),_:1})]),e(ue,{currentIndex:p.selectedRowKeys},null,8,["currentIndex"])]),e(U,{dataSource:g.value,columns:k,"row-selection":{selectedRowKeys:p.selectedRowKeys,onChange:I}},null,8,["dataSource","row-selection"])],64)}}},fe=E(pe,[["__scopeId","data-v-f443c573"]]);export{fe as default};
