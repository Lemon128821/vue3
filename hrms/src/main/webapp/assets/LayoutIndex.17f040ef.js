import{_ as W}from"./avatar.14ed01fe.js";import{_ as F,r as o,o as f,c as x,a as e,w as t,b as c,t as I,d as h,u as X,e as Y,f as Z,g as ee,h as te,i as n,F as P,j as oe,k as se,p as ae,l as ne,m as le,n as B,q as re}from"./index.bbbda2ab.js";import{u as ue,v as _e,a as ce}from"./channel.9989d84c.js";import{u as de}from"./limit.231b0a95.js";import"./request.5f96fccc.js";const ie="/assets/logo.a98f572a.jpg";const me={class:"box"},pe={__name:"Crumbs",props:{path:String},setup(_){return(v,b)=>{const d=o("a-breadcrumb-item"),w=o("a-breadcrumb");return f(),x("div",me,[e(w,null,{default:t(()=>[e(d,null,{default:t(()=>[c("Home")]),_:1}),e(d,null,{default:t(()=>[c(I(_.path),1)]),_:1})]),_:1})])}}},fe=F(pe,[["__scopeId","data-v-e74c7fd8"]]);const S=_=>(ae("data-v-621cd811"),_=_(),ne(),_),ve={class:"layoutHead"},we=S(()=>n("div",{class:"headLeft"},[n("div",{class:"logo"},[n("img",{src:ie,alt:""})]),n("div",{class:"title"},"\u4EBA\u529B\u8D44\u6E90\u7BA1\u7406\u5E73\u53F0")],-1)),ye={class:"headRight"},he={class:"demo-dropdown-wrap"},be=S(()=>n("img",{src:W},null,-1)),ge={class:"sel"},ke={class:"uname"},xe={class:"child"},Ie={__name:"LayoutIndex",setup(_){const v=h(null),b=X(),d=h("index"),w=h(""),j=b.options.routes.filter(a=>!a.hidden),C=a=>{if(a.children.length)return a.children.find(s=>!s.hidden).meta},r=Y({password:"",newpsw:"",confirm:""}),i=h(!1),U=Z(),m=ue(),H=de(),T=a=>{a.key==="1"?(v.value!=null&&v.value.resetFields(),i.value=!0):a.key==="2"&&L()},$=async(a,s)=>{const u=m.user.id,{message:y,result:p}=await _e(u,r.password);return s===""?Promise.reject("\u5BC6\u7801\u4E0D\u80FD\u4E3A\u7A7A"):p?Promise.resolve():Promise.reject(y)},D=(a,s)=>s!==r.newpsw?Promise.reject("\u5BC6\u7801\u4E0D\u4E00\u81F4"):Promise.resolve(),N=async a=>{const s=m.user.id,u=a.newpsw;await ce(s,u),le.warning("\u8BF7\u91CD\u65B0\u767B\u5F55!"),L(),i.value=!1},R=()=>{i.value=!1},L=()=>{U.deleteToken(),m.deleteUser(),H.deleteLimit(),b.push({name:"login"})};return ee(a=>{d.value=a.name}),te(async()=>{w.value=m.user!=null?m.user.name:""}),(a,s)=>{const u=o("a-menu-item"),y=o("a-menu"),p=o("a-button"),V=o("a-dropdown"),g=o("a-input-password"),k=o("a-form-item"),q=o("a-form"),M=o("a-modal"),O=o("router-link"),E=o("a-layout-sider"),z=o("HomeOutlined"),A=o("a-layout-header"),G=o("router-view"),J=o("a-layout-content"),K=o("a-layout");return f(),x(P,null,[n("header",ve,[we,n("div",ye,[n("div",he,[e(V,null,{overlay:t(()=>[e(y,{onClick:T},{default:t(()=>[e(u,{key:"1"},{default:t(()=>[c(" \u4FEE\u6539\u5BC6\u7801 ")]),_:1}),e(u,{key:"2"},{default:t(()=>[c(" \u9000\u51FA\u767B\u5F55 ")]),_:1})]),_:1})]),default:t(()=>[e(p,{class:"avatar"},{default:t(()=>[be]),_:1})]),_:1}),e(M,{visible:i.value,"onUpdate:visible":s[3]||(s[3]=l=>i.value=l),title:"\u4FEE\u6539\u5BC6\u7801",footer:null,closable:!1},{default:t(()=>[e(q,{model:r,ref_key:"resetf",ref:v,"label-col":{span:8},"wrapper-col":{span:12},autocomplete:"off",onFinish:N},{default:t(()=>[e(k,{label:"\u539F\u5BC6\u7801",name:"password",rules:[{validator:$,trigger:["blur"]}]},{default:t(()=>[e(g,{value:r.password,"onUpdate:value":s[0]||(s[0]=l=>r.password=l)},null,8,["value"])]),_:1},8,["rules"]),e(k,{label:"\u65B0\u5BC6\u7801",name:"newpsw",rules:[{required:!0,message:"\u8F93\u5165\u4E0D\u80FD\u4E3A\u7A7A!"},{pattern:/^\S{6,15}$/,message:"\u5FC5\u987B\u662F6-15\u7684\u975E\u7A7A\u767D\u5B57\u7B26"}]},{default:t(()=>[e(g,{value:r.newpsw,"onUpdate:value":s[1]||(s[1]=l=>r.newpsw=l)},null,8,["value"])]),_:1}),e(k,{label:"\u786E\u8BA4\u65B0\u5BC6\u7801",name:"confirm",rules:[{validator:D}]},{default:t(()=>[e(g,{value:r.confirm,"onUpdate:value":s[2]||(s[2]=l=>r.confirm=l)},null,8,["value"])]),_:1},8,["rules"]),n("div",ge,[e(p,{type:"primary",onClick:R},{default:t(()=>[c("\u53D6\u6D88")]),_:1}),e(p,{type:"primary",htmlType:"submit"},{default:t(()=>[c("\u786E\u8BA4")]),_:1})])]),_:1},8,["model"])]),_:1},8,["visible"])]),n("div",ke,I(w.value),1)])]),e(K,null,{default:t(()=>[e(E,null,{default:t(()=>[e(y,{style:{width:"200px"},mode:"vertical"},{default:t(()=>[(f(!0),x(P,null,oe(se(j),(l,Q)=>(f(),B(u,{key:Q},{default:t(()=>[e(O,{to:l.path},{default:t(()=>[(f(),B(re(C(l).icon))),n("span",null,I(C(l).title),1)]),_:2},1032,["to"])]),_:2},1024))),128))]),_:1})]),_:1}),e(J,null,{default:t(()=>[e(A,null,{default:t(()=>[e(z),e(fe,{path:d.value},null,8,["path"])]),_:1}),n("article",xe,[e(G)])]),_:1})]),_:1})],64)}}},Se=F(Ie,[["__scopeId","data-v-621cd811"]]);export{Se as default};
